# Sun Zi's Perfect Math Class

Category: Crypto (Beginner)

Points: 100

Solves: 801

>Everybody!! Sunzi's math class is about to begin!!!

### Solution

![Question 1](/images/SunZiQuestion.png)

Looks like they give us the classic tale of how CRT was invented, and now ask us to solve a case.

```math
\displaylines{
n \in [1000,1100] \\
n \equiv 2 \mod 3 \\
n \equiv 4 \mod 5 \\
n \equiv 5 \mod 7 \\
}
```

Sol:

```math
\displaylines{
n \equiv 2 \equiv -1 \mod 3 \\
n \equiv 4 \equiv -1 \mod 5 \\
\text{so} \\
n \equiv -1 \mod 15 \\
\text{next} \\
n \equiv -1 \equiv -16 \mod 15 \\
n \equiv 5 \equiv -16 \mod 7 \\
\text{so} \\
n \equiv -16 \mod 105 \\
\text{from here we can see that} \\
n=10\cdot105-16=1034 \in [1000,1100]
}
```

Submitting `1034` leads us to part2:

![Answer 1034](/images/SunZiAnswer.png)
![Part2](/images/SunZiQuestion2.png)

Now we need to use CRT for some giant numbers to get back $m^e$, then take the cube root since $e=3$. To do this we can use python libraries like `sympy` to do all the hard work for us:

```py
#!/usr/bin/env python3
from sympy.ntheory.modular import crt 
from sympy import integer_nthroot

e = 3

c_1 = 105001824161664003599422656864176455171381720653815905925856548632486703162518989165039084097502312226864233302621924809266126953771761669365659646250634187967109683742983039295269237675751525196938138071285014551966913785883051544245059293702943821571213612968127810604163575545004589035344590577094378024637

c_2 = 31631442837619174301627703920800905351561747632091670091370206898569727230073839052473051336225502632628636256671728802750596833679629890303700500900722642779064628589492559614751281751964622696427520120657753178654351971238020964729065716984136077048928869596095134253387969208375978930557763221971977878737

c_3 = 64864977037231624991423831965394304787965838591735479931470076118956460041888044329021534008265748308238833071879576193558419510910272917201870797698253331425756509041685848066195410586013190421426307862029999566951239891512032198024716311786896333047799598891440799810584167402219122283692655717691362258659

n_1 = 147896270072551360195753454363282299426062485174745759351211846489928910241753224819735285744845837638083944350358908785909584262132415921461693027899236186075383010852224067091477810924118719861660629389172820727449033189259975221664580227157731435894163917841980802021068840549853299166437257181072372761693

n_2 = 95979365485314068430194308015982074476106529222534317931594712046922760584774363858267995698339417335986543347292707495833182921439398983540425004105990583813113065124836795470760324876649225576921655233346630422669551713602423987793822459296761403456611062240111812805323779302474406733327110287422659815403

n_3 = 95649308318281674792416471616635514342255502211688462925255401503618542159533496090638947784818456347896833168508179425853277740290242297445486511810651365722908240687732315319340403048931123530435501371881740859335793804194315675972192649001074378934213623075830325229416830786633930007188095897620439987817

m = [n_1, n_2, n_3] 
v = [c_1, c_2, c_3] 
  
# Use crt() method  
crt_m_v = crt(m, v)  
      
m3 = crt_m_v[0]

m = integer_nthroot(m3,3)
assert m[1]

print(m[0])
```

Running this we get this giant number:
```
11564025922867522871782912815123211630478650327759091593792994457296772521676766420142199669845768991886967888274582504750347133
```

Submitting to the question yields the flag:

![Flag](/images/SunZiAnswer2.png)


### Flag

```DUCTF{btw_y0u_c4n_als0_us3_CRT_f0r_p4rt14l_fr4ct10ns}```
